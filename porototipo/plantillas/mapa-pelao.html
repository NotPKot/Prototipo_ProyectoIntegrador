<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mapa pelao</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-control-geocoder@1.16.0/dist/Control.Geocoder.js"></script>
    <style>
        body {
            margin: 10px;
            padding: 0;
        }

        #map {
            width: 100%;
            height: calc(100vh - 20px);
        }
    </style>

</head>

<body>
    <div class="contenedor">
        <div id="map" class="mapa-img"></div>
        <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
            integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="></script>
        <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                // se crea el mapa, con las coordenadas de Osorno como centro y un zoom de 13
                var map_init = L.map('map', {
                    center: [-40.57395, -73.13348],
                    zoom: 13
                });

                // se usa OpenStreetMap para agregar la imagen al mapa creado
                var osm = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
                    attribution: "&copy; <a href='https://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors"
                }).addTo(map_init);

                // se agrega un buscador para el mapa
                L.Control.geocoder().addTo(map_init);

                /*              ELIMINAR ESTA LíNEA PARA QUE TE DIGA TU UBICACIÓN
                // se comprueba si el navegador es compatible con geolocalización
                if (!navigator.geolocation) {
                    console.log("Su navegador no es compatible con geolocalización.");
                } else {
                    // se obtiene la ubicación actual del usuario
                    navigator.geolocation.getCurrentPosition(getPosition);
                }
                

                // se crean variables que se usarán más adelante
                var marker, circle, lat, long, accuracy;

                // se procesa la posición del usuario
                function getPosition(position) {
                    console.log(position);
                    lat = position.coords.latitude;
                    long = position.coords.longitude;
                    accuracy = position.coords.accuracy;

                    if (marker) {
                        map_init.removeLayer(marker);
                    }

                    if (circle) {
                        map_init.removeLayer(circle);
                    }

                    marker = L.marker([lat, long]);
                    circle = L.circle([lat, long], { radius: accuracy });

                    var featureGroup = L.featureGroup([marker, circle]).addTo(map_init);

                    // esto no es tan necesario pero por si acaso. luego de obtener la ubicación del usuario, se imprime en la consola
                    console.log("Sus coordenadas son: Latitud: " + lat + " Longitud: " + long + " Precisión: " + accuracy);
                }
                                ELIMINAR ESTA LíNEA PARA QUE TE DIGA TU UBICACIÓN            */
            });

        </script>

    </div>

</body>

</html>